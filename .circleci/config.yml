version: 2.1

orbs:
  myorb:
    executors:
      default:
        parameters:
          image-name:
            type: string
            default: "cimg/rust"
          image-tag:
            type: string
            default: "1.50.0"
        docker:
          - image: << parameters.image-name>>:<< parameters.image-tag >>

  rover:
    commands:
      install:
        parameters:
          version:
            type: string
            default: "v0.0.4"
        steps:
          - run: curl -sSL https://raw.githubusercontent.com/apollographql/rover/<< parameters.version >>/installers/binstall/scripts/nix/install.sh | sh
          - run: echo 'export PATH=$HOME/.rover/bin:$PATH' >> $BASH_ENV
      build:
        parameters:
          path:
            type: string
        steps:
          - run: rover core build --config << parameters.path >>




jobs:
  build:
    executor: myorb/default
    steps:
      - run: docker -v
      - rover/install
      - run: rover --version
      - rover/build:
          path: supergraph.yml
  
workflows:
  mine:
    jobs:
      - build




version: 2.1

orbs:
    hello: circleci/hello-build@volatile
    orb-magic:
      jobs:
        illuminate-this-build:
          docker:
            - image: circleci/python:3.6.6
          parameters:
            checkout:
              type: boolean
              default: true
              description: >
                Boolean for whether to run a `checkout` first
                 - default is false for the command, assuming you
                 may have already done checkout in your job.
          steps:
            - when:
                condition: << parameters.checkout >>
                steps:
                  - checkout
            - run:
                name: Install yq
                command: |
                  sudo pip install yq
            - run:
                name: Parse .circleci/config.yml
                command: |
                  cat .circleci/config.yml | yq .orbs[]
workflows:
    "Orb Magic":
        jobs:
          - orb-magic/illuminate-this-build